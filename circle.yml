test:
  override:
    - ./gradlew testRelease --tests se.paldan.helloworld.ExampleUnitTest;
    - ./gradlew testRelease --tests se.paldan.helloworld.ExampleUnitTestTwo;
    - ./gradlew testRelease --tests se.paldan.helloworld.ExampleUnitTestThree;
    - ./gradlew testRelease --tests se.paldan.helloworld.ExampleUnitTestFour;
    - ./gradlew testRelease --tests se.paldan.helloworld.ExampleUnitTestFive;
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - find . -type f -regex ".*/app/build/test-results/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;
    - ./gradlew assembleRelease
    - find . -type f -regex ".*/app/build/outputs/.*apk" -exec cp {} $CIRCLE_ARTIFACTS \;
    - if [[ ! -z $CI_PULL_REQUEST ]] ; then   
        echo "Generating test coverage report...";
        mkdir -p $CIRCLE_TEST_REPORTS/coverage/;
        ./gradlew app:testDebugUnitTestCoverage;
        find . -type f -regex ".*/app/build/reports/jacoco/testDebugUnitTestCoverage/html/*" -exec cp {} $CIRCLE_TEST_REPORTS/coverage/;
      fi;
